<html>
    <head>
        <title>adrn</title>
        <link href='http://fonts.googleapis.com/css?family=Carrois+Gothic' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" media="screen" href="css/colorbrewer.css" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        
        <style type="text/css">
            #header {
                margin: 20px;
                padding: 10px;
                position: absolute;
                z-index: 10000;
                text-align: center;
                color: rgb(180, 180, 180);
                background: #333;
                border-radius: 5px;
                width: 24%;
            }
            
            #header table{
                color: rgb(150, 150, 150);
            }
            
            #header table td {
                font-size: 10pt;
            }
            
            #U_display { 
                color: rgb(150, 150, 150);
                font-size: 10pt;
            }
            
            #header table td.label {
                text-align: right;
                font-size: 14pt;
                color: rgb(200, 200, 200);
            }
            
            #header table td.component_name {
                text-align: center;
                font-size: 16pt;
                color: rgb(210, 210, 210);
                border-bottom: 1px solid rgb(150, 150, 150);
            }
            
            #header h1 {
                color: #3871B2;
                text-shadow: 1px 1px 3px #111;
            }
            
            #footer {
                position: absolute;
                bottom: 10px;
                right: 10px;
                font-size: 10pt;
                color: #666;
            }
        </style>
        
        <!--
        For production:
        <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
        <script src="http://d3js.org/d3.v2.js"></script>
        -->
        
        <!--
        For development:
        -->
        <script type="text/javascript" src="js/jquery-1.6.1.min.js"></script>
        <script type="text/javascript" src="js/d3.v2.min.js"></script>
        
        <script type="text/javascript" src="js/galaxy.js"></script>
        <script type="text/javascript" src="js/colorbrewer.js"></script>
	
        <script type="text/javascript">    
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-11936482-10']);
            _gaq.push(['_trackPageview']);
            
            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
	
    </head>
    
    <body bgcolor="black">
        <div id="header">
            <h1>Logarithmic Potential</h1><br/>
            <img src="images/potential.png" width="100%" /><br/><br/>
            <!--<hr size=1 width="70%"/>-->
            
            <table cellpadding=5 cellspacing=10 width="100%">
                <tr>
                    <td colspan=2 class="label" style="text-align: center;">U:
                        <input type="range" style="width: 100px;" id="log_U" min="0.707" max="1.08" value="0.8" step="0.01" onChange="$('#U_display').text($(this).val());"/>
                        <span id="U_display">0.800</span>
                    </td>
                </tr>
                <tr>
                    <td colspan=2 class="label" style="text-align: center;">
                        &Delta;t: <input type="text" id="dt" value="1" size=5 onChange="create_galaxy();" />
                    </td>
                </tr>
                
                <tr>
                    <td colspan=2></td>
                </tr>
                
                <!-- Disk -->
                <tr>
                    <td class="component_name" colspan=2>Disk&nbsp;&nbsp;<input type="checkbox" id="add_disk" checked=checked onChange="restart();" /></td>
                </tr>
                <tr>
                    <td class="label"># of stars:</td>
                    <td><input type="text" id="num_disk_stars" value="3000" size=10 /></td>
                </tr>
                <tr>
                    <td class="label">Radius:</td>
                    <td><input type="text" id="disk_radius" value="5" size=8 />&nbsp;px</td>
                </tr>
                <tr>
                    <td class="label">Dispersion (%):</td>
                    <td><input type="text" id="disk_dispersion" value="10" size=5 />&nbsp;%</td>
                </tr>
                
                <tr>
                    <td colspan=2></td>
                </tr>
                
                <!-- Bulge -->
                <tr>
                    <td class="component_name" colspan=2>Bulge&nbsp;&nbsp;<input type="checkbox" id="add_bulge" checked=checked onChange="restart();" /></td>
                </tr>
                <tr>
                    <td class="label"># of stars:</td>
                    <td><input type="text" id="num_bulge_stars" value="500" size=10 /></td>
                </tr>
                <tr>
                    <td class="label">Dispersion (%):</td>
                    <td><input type="text" id="bulge_dispersion" value="100" size=5 />&nbsp;%</td>
                </tr>

            </table>
            <br/><br/>
            <input type="button" value="Start" onClick="start();" />
            <input type="button" value="Pause" onClick="stop();" />
            <input type="button" value="Restart" onClick="restart();" />
        </div>
        
        <canvas id="bgcanvas"></canvas>
        
        <div id="footer">
            adrn at astro.columbia.edu
        </div>
    </body>
    
    <script type="text/javascript">
        var canvas = document.getElementById('bgcanvas'),
            context = canvas.getContext('2d');
        
        // Fill the browser with the canvas
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        // Default disk radius is canvas.height/3.
        $("#disk_radius").val(parseInt(canvas.height/3.));
        
        var interval;
        var galaxy;
        colors = {"bulge" : "rgba(217, 100, 100, 0.85)"};
        
        function create_galaxy() {
            // Create a new Galaxy in the center of the screen
            galaxy = new Galaxy(canvas.width/2., canvas.height/2., $("#log_U").val());
            
            if ($('#add_disk').is(':checked')) {
                galaxy.add_disk(number=parseInt($("#num_disk_stars").val()), 
                    radius=parseFloat($("#disk_radius").val()), 
                    dispersion=parseFloat($("#disk_dispersion").val())); // % dispersion
            }
            
            if ($('#add_bulge').is(':checked')) {
                galaxy.add_bulge(number=parseInt($("#num_bulge_stars").val()), 
                    radius=parseFloat($("#disk_radius").val())/8., 
                    dispersion=parseFloat($("#bulge_dispersion").val()));
            }
        }
        
        function restart() {
            stop();
            create_galaxy();
            start();
        }
        
        function draw_update() {
            galaxy.draw(context, colors);
            galaxy.update($('#dt').val());
        }
        
        function start() {
            stop();
            interval = setInterval(draw_update, 10);
        }
        
        function stop() {
            window.clearInterval(interval);
        }
        
        create_galaxy();
        start();

    </script>
</html>
